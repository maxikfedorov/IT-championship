<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–∞–Ω–µ–ª—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –¥–≤–∏–≥–∞—Ç–µ–ª–µ–π</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
<style>
/* ---------- Liquid Glass : –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π –º–∏–Ω–∏–º–∞–ª–∏–∑–º ---------- */
:root{
  --primary:#6d8df6;
  --success:#10b981;
  --danger:#ef4444;
  --warning:#f59e0b;
  --info:#3b82f6;

  --glass-bg:rgba(255,255,255,.12);
  --glass-brd:rgba(255,255,255,.25);
  --glass-blur:blur(18px) saturate(140%);
  --shadow-sm:0 2px 6px rgba(0,0,0,.12);
  --shadow-lg:0 6px 20px rgba(0,0,0,.18);

  --text-dark:#111827;
  --text-light:#000000;
}

html{font-size:14px;}
body{
  font-family:'Inter',sans-serif;
  background:linear-gradient(135deg,#eef2ff 0%,#cfd9ff 100%);
  color:var(--text-dark);
  margin:0;
  min-height:100vh;
}

/* --- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä --- */
.main-container{
  max-width:1600px;
  margin:auto;
  padding:1.5rem;
}

/* --- –ö–∞—Ä—Ç–æ—á–∫–∏ (Liquid Glass) --- */
.card,
.status-card{
  background:var(--glass-bg);
  border:1px solid var(--glass-brd);
  backdrop-filter:var(--glass-blur);
  -webkit-backdrop-filter:var(--glass-blur);
  border-radius:12px;
  box-shadow:var(--shadow-sm);
  transition:.25s;
}
.card:hover,
.status-card:hover{
  transform:translateY(-3px);
  box-shadow:var(--shadow-lg);
}

/* --- –ó–∞–≥–æ–ª–æ–≤–∫–∏ --- */
.card-header{
  padding:.9rem 1.2rem;
  border:none;
  font-weight:600;
  font-size:1rem;
  color:var(--text-dark) !important; /* —á–µ—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö */
}


/* --- –¢–µ–ª–æ --- */
.card-body{padding:1rem 1.2rem;}

/* --- –û–±—â–∏–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ --- */
.page-title{
  font-size:1.8rem;
  margin-bottom:2rem;
}

/* --- –ë–ª–æ–∫ —Å—Ç–∞—Ç—É—Å–∞ --- */
.status-display{
  display:flex;
  justify-content:space-between;
  align-items:center;
  background:rgba(255,255,255,.08);
  backdrop-filter:blur(14px);
  -webkit-backdrop-filter:blur(14px);
  padding:.7rem 1rem;
  border-radius:10px;
  margin-bottom:1rem;
}
.status-running{color:var(--success);font-weight:600;}
.status-error{color:var(--danger);font-weight:600;}

/* --- –ö–Ω–æ–ø–∫–∏ --- */
.btn{
  border-radius:8px;
  font-size:.8rem;
  padding:.45rem .9rem;
  line-height:1.2;
}
.action-buttons{gap:.5rem;}

/* --- –°–µ—Ç–∫–∞ –∏–Ω—Ñ–æ --- */
.info-grid{
  display:grid;
  grid-template-columns:1fr;
  gap:.25rem;
  font-size:.75rem;
}
.info-item{padding:.25rem;}

/* --- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ --- */
.stats-grid{display:grid;gap:.75rem;}
.stat-card{
  background:rgba(255,255,255,.08);
  backdrop-filter:blur(14px);
  -webkit-backdrop-filter:blur(14px);
  padding:.75rem;
  border-radius:10px;
  border-left:3px solid var(--primary);
}
.stat-value{font-size:1.25rem;font-weight:700;}
/* —Ü–≤–µ—Ç–Ω—ã–µ –ª–µ–Ω—Ç—ã */
.stat-card.danger{border-left-color:var(--danger);}
.stat-card.success{border-left-color:var(--success);}

/* --- –õ–æ–≥–∏ --- */
.log-output{
  height:220px;
  overflow-y:auto;
  background:#1f2937;
  color:var(--text-light);
  font-family:'Fira Code',monospace;
  font-size:11.5px;
  border-radius:12px;
  padding:.8rem;
  border:none;
}

/* --- –ê–≤—Ç–æ-–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ --- */
.auto-refresh{
  position:fixed;
  top:15px;right:15px;
  padding:.5rem .9rem;
  border-radius:30px;
  background:var(--glass-bg);
  border:1px solid var(--glass-brd);
  backdrop-filter:var(--glass-blur);
  -webkit-backdrop-filter:var(--glass-blur);
  z-index:1000;
}
.form-switch .form-check-input{
  width:2.4rem;height:1.2rem;
}

/* --- –£–ø–ª–æ—Ç–Ω–µ–Ω–∏–µ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ --- */
.row{margin-bottom:1rem;}

/* --- –ê–¥–∞–ø—Ç–∞—Ü–∏—è –¥–ª—è –±–æ–ª—å—à–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤ --- */
@media(min-width:1400px){
  /* –¥–≤–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –∑–∞–ø–æ–ª–Ω—è—é—Ç —ç–∫—Ä–∞–Ω –±–µ–∑ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ */
  .row{flex-wrap:nowrap;}
  .status-card{height:100%;}
  /* ¬´–†–µ–∑—É–ª—å—Ç–∞—Ç—ã¬ª –∏ ¬´–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è¬ª —Ä—è–¥–æ–º */
  .row> .col-12:not(:first-child){
    flex:0 0 50%;
    max-width:50%;
  }
  .log-output{height:200px;}
}
</style>

</head>
<body>
    <div class="main-container">
        <div class="auto-refresh">
            <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" id="autoRefresh" checked>
                <label class="form-check-label" for="autoRefresh">–ê–≤—Ç–æ-–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ</label>
            </div>
        </div>

        <h1 class="page-title">üîß –ü–∞–Ω–µ–ª—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –¥–≤–∏–≥–∞—Ç–µ–ª–µ–π</h1>
        
        <div class="row">
            <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ—Ç–æ—Ä–æ–º -->
            <div class="col-lg-6">
                <div class="card status-card">
                    <div class="card-header" style="background: linear-gradient(135deg, var(--primary-color), var(--info-color)); color: white;">
                        <span>üè≠ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–º –¥–≤–∏–≥–∞—Ç–µ–ª—è</span>
                    </div>
                    <div class="card-body">
                        <div class="status-display">
                            <span class="status-text">–°—Ç–∞—Ç—É—Å: <span id="motorStatus" class="fw-bold">–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ</span></span>
                            <button class="btn btn-outline-secondary btn-sm" onclick="refreshMotorStatus()">üîÑ</button>
                        </div>
                        
                        <div class="action-buttons">
                            <button class="btn btn-success" onclick="startMotor()">‚ñ∂Ô∏è –ó–∞–ø—É—Å—Ç–∏—Ç—å</button>
                            <button class="btn btn-danger" onclick="stopMotor()">‚èπÔ∏è –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
                            <button class="btn btn-primary" onclick="getMotorConfig()">‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è</button>
                        </div>
                        
                        <div class="info-grid mt-3">
                            <div class="info-item">
                                <span class="info-label">WebSocket:</span>
                                <span id="motorWS" class="info-value">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">–û–∫—Ä—É–∂–µ–Ω–∏–µ:</span>
                                <span id="motorEnv" class="info-value">-</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–æ–º -->
            <div class="col-lg-6">
                <div class="card status-card">
                    <div class="card-header" style="background: linear-gradient(135deg, var(--success-color), #059669); color: white;">
                        <span>ü§ñ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ AI –ø–∞–π–ø–ª–∞–π–Ω–æ–º</span>
                    </div>
                    <div class="card-body">
                        <div class="status-display">
                            <span class="status-text">–°—Ç–∞—Ç—É—Å: <span id="pipelineStatus" class="fw-bold">–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ</span></span>
                            <button class="btn btn-outline-secondary btn-sm" onclick="refreshPipelineStatus()">üîÑ</button>
                        </div>
                        
                        <div class="action-buttons">
                            <button class="btn btn-success" onclick="startPipeline()">üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å</button>
                            <button class="btn btn-danger" onclick="stopPipeline()">‚èπÔ∏è –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
                            <button class="btn btn-warning" onclick="stopAllPipelines()">üõë –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å—ë</button>
                        </div>
                        
                        <div class="info-grid mt-3">
                            <div class="info-item">
                                <span class="info-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</span>
                                <span id="activeUsers" class="info-value">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">–û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤:</span>
                                <span id="batchesProcessed" class="info-value">-</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ -->
        <div class="row">
            <div class="col-12">
                <div class="card status-card">
                    <div class="card-header" style="background: linear-gradient(135deg, var(--info-color), #2563eb); color: white;">
                        <div class="d-flex justify-content-between align-items-center">
                            <span>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥</span>
                            <div>
                                <button class="btn btn-sm btn-light me-2" onclick="getLatestResults()">üìà –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</button>
                                <button class="btn btn-sm btn-light" onclick="clearLogs()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-lg-5">
                                <h6 class="section-title">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–∞–π–ø–ª–∞–π–Ω–∞</h6>
                                <div class="stats-grid">
                                    <div class="stat-card">
                                        <span id="statsFeatures" class="stat-value">-</span>
                                        <div class="stat-label">–ò–∑–≤–ª–µ—á–µ–Ω–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</div>
                                    </div>
                                    <div class="stat-card">
                                        <span id="statsAutoencoder" class="stat-value">-</span>
                                        <div class="stat-label">–ó–∞–ø—É—Å–∫–æ–≤ –∞–≤—Ç–æ—ç–Ω–∫–æ–¥–µ—Ä–∞</div>
                                    </div>
                                    <div class="stat-card">
                                        <span id="statsLSTM" class="stat-value">-</span>
                                        <div class="stat-label">–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π LSTM</div>
                                    </div>
                                    <div class="stat-card" style="border-left-color: var(--danger-color);">
                                        <span id="statsAnomalies" class="stat-value" style="color: var(--danger-color);">-</span>
                                        <div class="stat-label">–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ –∞–Ω–æ–º–∞–ª–∏–π</div>
                                    </div>
                                    <div class="stat-card" style="border-left-color: var(--success-color);">
                                        <span id="statsHealthy" class="stat-value" style="color: var(--success-color);">-</span>
                                        <div class="stat-label">–ó–¥–æ—Ä–æ–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤</div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-7">
                                <h6 class="section-title">–ñ—É—Ä–Ω–∞–ª –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</h6>
                                <div id="logOutput" class="log-output"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
        <div class="row">
            <div class="col-12">
                <div class="card status-card">
                    <div class="card-header" style="background: linear-gradient(135deg, var(--warning-color), #d97706); color: white;">
                        <span>‚ö° –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</span>
                    </div>
                    <div class="card-body">
                        <div class="action-buttons">
                            <button class="btn btn-primary" onclick="runFullDiagnostic()">üîç –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞</button>
                            <button class="btn btn-success" onclick="getSystemHealth()">‚ù§Ô∏è –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã</button>
                            <button class="btn btn-info" onclick="downloadResults()">üíæ –°–∫–∞—á–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</button>
                            <button class="btn btn-danger" onclick="emergencyStop()">üö® –ê–≤–∞—Ä–∏–π–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = window.location.origin;
        const MOTOR_BASE = API_BASE.replace('8000', '8005');
        const USER_ID = 'dashboard_user';
        let autoRefreshInterval;

        // Auto refresh setup
        document.getElementById('autoRefresh').addEventListener('change', function() {
            if (this.checked) {
                startAutoRefresh();
            } else {
                stopAutoRefresh();
            }
        });

        function startAutoRefresh() {
            autoRefreshInterval = setInterval(() => {
                refreshMotorStatus();
                refreshPipelineStatus();
            }, 3000);
        }

        function stopAutoRefresh() {
            if (autoRefreshInterval) {
                clearInterval(autoRefreshInterval);
            }
        }

        // Logging
        function addLog(message, type = 'info') {
            const logOutput = document.getElementById('logOutput');
            const timestamp = new Date().toLocaleTimeString();
            const colorClass = type === 'error' ? 'text-danger' : type === 'success' ? 'text-success' : 'text-info';
            logOutput.innerHTML += `<div class="${colorClass}">[${timestamp}] ${message}</div>`;
            logOutput.scrollTop = logOutput.scrollHeight;
        }

        function clearLogs() {
            document.getElementById('logOutput').innerHTML = '';
        }

        // Motor Control
        async function startMotor() {
            try {
                const response = await fetch(`${MOTOR_BASE}/start`, { method: 'POST' });
                const result = await response.json();
                addLog(`Motor started: ${result.status}`, 'success');
                refreshMotorStatus();
            } catch (error) {
                addLog(`Failed to start motor: ${error.message}`, 'error');
            }
        }

        async function stopMotor() {
            try {
                const response = await fetch(`${MOTOR_BASE}/stop`, { method: 'POST' });
                const result = await response.json();
                addLog(`Motor stopped: ${result.status}`, 'success');
                refreshMotorStatus();
            } catch (error) {
                addLog(`Failed to stop motor: ${error.message}`, 'error');
            }
        }

        async function refreshMotorStatus() {
            try {
                const response = await fetch(`${MOTOR_BASE}/status`);
                const status = await response.json();
                
                document.getElementById('motorStatus').textContent = status.running ? '–†–∞–±–æ—Ç–∞–µ—Ç' : '–û—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω';
                document.getElementById('motorStatus').className = status.running ? 'fw-bold status-running' : 'fw-bold status-error';
                document.getElementById('motorWS').textContent = status.websocket_url || '-';
                document.getElementById('motorEnv').textContent = status.environment || '-';
            } catch (error) {
                document.getElementById('motorStatus').textContent = '–û—à–∏–±–∫–∞';
                document.getElementById('motorStatus').className = 'fw-bold status-error';
                addLog(`Motor status check failed: ${error.message}`, 'error');
            }
        }

        async function getMotorConfig() {
            try {
                const response = await fetch(`${MOTOR_BASE}/status`);
                const status = await response.json();
                addLog(`Motor config: ${JSON.stringify(status.config, null, 2)}`, 'info');
            } catch (error) {
                addLog(`Failed to get motor config: ${error.message}`, 'error');
            }
        }

        // Pipeline Control
        async function startPipeline() {
            try {
                const response = await fetch(`${API_BASE}/streaming/pipeline/start/${USER_ID}`, { method: 'POST' });
                const result = await response.json();
                addLog(`Pipeline started: ${result.status} (Session: ${result.session_id})`, 'success');
                refreshPipelineStatus();
            } catch (error) {
                addLog(`Failed to start pipeline: ${error.message}`, 'error');
            }
        }

        async function stopPipeline() {
            try {
                const response = await fetch(`${API_BASE}/streaming/pipeline/stop/${USER_ID}`, { method: 'POST' });
                const result = await response.json();
                addLog(`Pipeline stopped: ${result.status}`, 'success');
                refreshPipelineStatus();
            } catch (error) {
                addLog(`Failed to stop pipeline: ${error.message}`, 'error');
            }
        }

        async function stopAllPipelines() {
            try {
                const response = await fetch(`${API_BASE}/streaming/pipeline/stop-all`, { method: 'POST' });
                const result = await response.json();
                addLog(`Stopped ${result.count} pipelines`, 'success');
                refreshPipelineStatus();
            } catch (error) {
                addLog(`Failed to stop all pipelines: ${error.message}`, 'error');
            }
        }

        async function refreshPipelineStatus() {
            try {
                // Get specific user status
                const userResponse = await fetch(`${API_BASE}/streaming/pipeline/status/${USER_ID}`);
                if (userResponse.ok) {
                    const userStatus = await userResponse.json();
                    document.getElementById('pipelineStatus').textContent = '–†–∞–±–æ—Ç–∞–µ—Ç';
                    document.getElementById('pipelineStatus').className = 'fw-bold status-running';
                    document.getElementById('batchesProcessed').textContent = userStatus.processed_batches || 0;
                    
                    // Update stats
                    const stats = userStatus.pipeline_stats || {};
                    document.getElementById('statsFeatures').textContent = stats.total_features || 0;
                    document.getElementById('statsAutoencoder').textContent = stats.total_autoencoder || 0;
                    document.getElementById('statsLSTM').textContent = stats.total_lstm || 0;
                    document.getElementById('statsAnomalies').textContent = stats.anomalies_detected || 0;
                    document.getElementById('statsHealthy').textContent = stats.healthy_batches || 0;
                } else {
                    document.getElementById('pipelineStatus').textContent = '–û—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω';
                    document.getElementById('pipelineStatus').className = 'fw-bold status-error';
                    document.getElementById('batchesProcessed').textContent = '0';
                }

                // Get all active users
                const allResponse = await fetch(`${API_BASE}/streaming/pipeline/users`);
                const allUsers = await allResponse.json();
                document.getElementById('activeUsers').textContent = allUsers.count || 0;

            } catch (error) {
                document.getElementById('pipelineStatus').textContent = '–û—à–∏–±–∫–∞';
                document.getElementById('pipelineStatus').className = 'fw-bold status-error';
                addLog(`Pipeline status check failed: ${error.message}`, 'error');
            }
        }

        // Results & Monitoring
        async function getLatestResults() {
            try {
                const response = await fetch(`${API_BASE}/autoencoder/batch/${USER_ID}_latest/results`);
                if (response.ok) {
                    const results = await response.json();
                    addLog(`Latest results: ${results.count} windows processed`, 'success');
                    if (results.results && results.results.length > 0) {
                        const latest = results.results[0];
                        addLog(`System status: ${latest.overall.system_health_status}, Confidence: ${latest.overall.overall_confidence_score}`, 'info');
                    }
                } else {
                    addLog('No recent results found', 'info');
                }
            } catch (error) {
                addLog(`Failed to get results: ${error.message}`, 'error');
            }
        }

        async function getSystemHealth() {
            try {
                const aiHealth = await fetch(`${API_BASE}/health`);
                const motorHealth = await fetch(`${MOTOR_BASE}/health`);
                
                const aiStatus = await aiHealth.json();
                const motorStatus = await motorHealth.json();
                
                addLog(`System Health Check:`, 'info');
                addLog(`- AI Services: ${aiStatus.status}`, aiStatus.status === 'healthy' ? 'success' : 'error');
                addLog(`- Motor Generator: ${motorStatus.status}`, motorStatus.status === 'healthy' ? 'success' : 'error');
            } catch (error) {
                addLog(`Health check failed: ${error.message}`, 'error');
            }
        }

        async function runFullDiagnostic() {
            addLog('üîç Starting full diagnostic...', 'info');
            
            // Check if motor is running
            await refreshMotorStatus();
            const motorRunning = document.getElementById('motorStatus').textContent === '–†–∞–±–æ—Ç–∞–µ—Ç';
            
            if (!motorRunning) {
                addLog('‚ö†Ô∏è Motor not running, starting motor...', 'info');
                await startMotor();
                await new Promise(resolve => setTimeout(resolve, 2000)); // Wait 2 seconds
            }
            
            // Check if pipeline is running
            await refreshPipelineStatus();
            const pipelineRunning = document.getElementById('pipelineStatus').textContent === '–†–∞–±–æ—Ç–∞–µ—Ç';
            
            if (!pipelineRunning) {
                addLog('‚ö†Ô∏è Pipeline not running, starting pipeline...', 'info');
                await startPipeline();
            }
            
            addLog('‚úÖ Full diagnostic started, monitoring...', 'success');
        }

        async function downloadResults() {
            addLog('üì• Download functionality not implemented yet', 'info');
        }

        async function emergencyStop() {
            addLog('üö® Emergency stop initiated', 'error');
            await stopAllPipelines();
            await stopMotor();
            addLog('üõë All systems stopped', 'success');
        }

        // Initialize
        window.onload = function() {
            addLog('üöÄ Dashboard initialized', 'success');
            refreshMotorStatus();
            refreshPipelineStatus();
            startAutoRefresh();
        };
    </script>
</body>
</html>
